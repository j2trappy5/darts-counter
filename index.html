<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Darts Calculator</title>
  <style>
    body {
      <h1 style="color:red">TEST CHANGE</h1>
      font-family: Arial, sans-serif;
      background: #111;
      color: #fff;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 { margin-bottom: 10px; }
    .game-select button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    .score {
      font-size: 32px;
      margin: 15px 0;
    }
    .finish {
      margin: 10px 0;
      font-size: 18px;
      color: #0f0;
    }
    .board button {
      width: 60px;
      height: 40px;
      margin: 4px;
      font-size: 16px;
      cursor: pointer;
    }
    .multiplier button {
      width: 80px;
    }
  </style>
</head>
<body>

<h1>Darts Calculator</h1>

<div class="game-select">
  <p>Choose game:</p>
  <button onclick="startGame(301)">301</button>
  <button onclick="startGame(501)">501</button>
</div>

<div class="score" id="score">Score: --</div>
<div class="finish" id="finish"></div>

<div class="multiplier">
  <button onclick="setMultiplier(1)">Single</button>
  <button onclick="setMultiplier(2)">Double</button>
  <button onclick="setMultiplier(3)">Treble</button>
</div>

<div class="board">
  <script>
    for (let i = 1; i <= 20; i++) {
      document.write(`<button onclick=\"throwDart(${i})\">${i}</button>`);
    }
  </script>
  <br>
  <button onclick="throwBull(25)">Outer Bull (25)</button>
  <button onclick="throwBull(50)">Bullseye (50)</button>
</div>

<script>
  let score = null;
  let multiplier = 1;

  function startGame(startScore) {
    score = startScore;
    updateDisplay();
  }

  function setMultiplier(m) {
    multiplier = m;
  }

  function throwDart(value) {
    if (score === null) return;

    let dartScore = value * multiplier;
    applyScore(dartScore);
    multiplier = 1; // reset to single after throw
  }

  function throwBull(value) {
    if (score === null) return;
    applyScore(value);
  }

  function applyScore(dartScore) {
    let newScore = score - dartScore;

    // Bust rules
    if (newScore < 0 || newScore === 1) return;

    // Double-out rule
    if (newScore === 0 && dartScore % 2 !== 0) return;

    score = newScore;
    updateDisplay();

    if (score === 0) {
      alert("Game shot! Well played ðŸŽ¯");
    }
  }

  function updateDisplay() {
    document.getElementById("score").innerText = "Score: " + score;
    document.getElementById("finish").innerText = getFinish(score);
  }

  function getFinish(s) {
    const finishes = {
      170: "T20 T20 Bull",
      167: "T20 T19 Bull",
      164: "T20 T18 Bull",
      161: "T20 T17 Bull",
      160: "T20 T20 D20",
      158: "T20 T20 D19",
      157: "T20 T19 D20",
      156: "T20 T20 D18",
      155: "T20 T19 D19",
      154: "T20 T18 D20",
      153: "T20 T19 D18",
      152: "T20 T20 D16",
      151: "T20 T17 D20",
      150: "T20 T18 D18",
      149: "T20 T19 D16",
      148: "T20 T16 D20",
      147: "T20 T17 D18",
      146: "T20 T18 D16",
      145: "T20 T15 D20",
      144: "T20 T20 D12",
      143: "T20 T17 D16",
      142: "T20 T14 D20",
      141: "T20 T19 D12",
      140: "T20 T20 D10",
      139: "T20 T13 D20",
      138: "T20 T18 D12",
      137: "T20 T19 D10",
      136: "T20 T20 D8",
      135: "T20 T17 D12",
      134: "T20 T14 D16",
      133: "T20 T19 D8",
      132: "T20 T20 D6",
      131: "T20 T13 D16",
      130: "T20 T20 D5",
      129: "T19 T20 D6",
      128: "T18 T14 D16",
      127: "T20 T17 D8",
      126: "T19 T19 D6",
      125: "25 T20 D20",
      124: "T20 T16 D8",
      123: "T19 T16 D9",
      122: "T18 T20 D4",
      121: "T20 T11 D14",
      120: "T20 S20 D20",
      100: "T20 D20",
      80: "T20 D10",
      60: "20 D20",
      50: "10 D20",
      40: "D20",
      32: "D16",
      24: "D12",
      16: "D8",
      8: "D4",
      4: "D2",
      2: "D1"
    };

    if (finishes[s]) return "Finish: " + finishes[s];
    if (s <= 170) return "Finish possible";
    return "";
  }
</script>

</body>
</html>
